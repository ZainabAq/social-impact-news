USE social_impact;
DROP TABLE IF EXISTS PoliticsAll;
-- 
CREATE TABLE PoliticsAll(
    URL VARCHAR(255) NOT NULL default '',
    Impact INT(255) NOT NULL default 0,
    Title VARCHAR(255) NOT NULL default '',
    Visitors INT(255) NOT NULL default 0,
    Views INT(255) NOT NULL default 0,
    Engaged_minutes INT(255) NOT NULL default 0,
    New_visitors INT(255) NOT NULL default 0,
    Returning_visitors INT(255) NOT NULL default 0,
    Avg_views_new_visitors INT(255) NOT NULL default 0,
    Avg_views_ret_visitors INT(255) NOT NULL default 0,
    Avg_minutes_new_visitors INT(255) NOT NULL default 0,
    Avg_minutes_ret_visitors INT(255) NOT NULL default 0,
    Desktop_views INT(255) NOT NULL default 0,
    Mobile_views INT(255) NOT NULL default 0,
    Tablet_views INT(255) NOT NULL default 0,
    Search_refs INT(255) NOT NULL default 0,
    Internal_refs INT(255) NOT NULL default 0,
    Other_refs INT(255) NOT NULL default 0,
    Direct_refs INT(255) NOT NULL default 0,
    Fb_refs INT(255) NOT NULL default 0,
    Tw_refs  INT(255) NOT NULL default 0,
    Fb_interactions INT(255) NOT NULL default 0,
    Tw_interactions INT(255) NOT NULL default 0,
    Readability FLOAT(255, 10) NOT NULL default 0.0,
    Grade_level FLOAT(255,10) NOT NULL default 0.0,
    Smog_index FLOAT(255,10) NOT NULL default 0.0,
    Total_words INT(255) NOT NULL default 0,
    Total_sentences INT(255) NOT NULL default 0,
    Neg1 FLOAT(255,10) NOT NULL default 0.0,
    Neg2 FLOAT(255,10) NOT NULL default 0.0,
    Neg3 FLOAT(255,10) NOT NULL default 0.0,
    Neg4 FLOAT(255,10) NOT NULL default 0.0,
    Neg5 FLOAT(255,10) NOT NULL default 0.0,
    Pos1 FLOAT(255,10) NOT NULL default 0.0,
    Pos2 FLOAT(255,10) NOT NULL default 0.0,
    Pos3 FLOAT(255,10) NOT NULL default 0.0,
    Pos4 FLOAT(255,10) NOT NULL default 0.0,
    Pos5 FLOAT(255,10) NOT NULL default 0.0,
    Other_social_refs INT(255) NOT NULL default 0,
    Li_refs  INT(255) NOT NULL default 0,
    Pi_refs  INT(255) NOT NULL default 0,
    Other_interactions INT(255) NOT NULL default 0,
    Li_interactions INT(255) NOT NULL default 0,
    Pi_interactions INT(255) NOT NULL default 0,
    Impact_binary VARCHAR(255) NOT NULL default '',
    Engaged_hours INT(255) NOT NULL default 0,
    Returning_visitors_10000 INT(255) NOT NULL default 0,
    Search_refs_10000 INT(255) NOT NULL default 0,
    Internal_refs_10000 INT(255) NOT NULL default 0,
    Other_refs_10000 INT(255) NOT NULL default 0,
    Direct_refs_10000 INT(255) NOT NULL default 0,
    Fb_refs_10000 INT(255) NOT NULL default 0,
    Tw_refs_10000  INT(255) NOT NULL default 0,
    Fb_interactions_10000 INT(255) NOT NULL default 0,
    Tw_interactions_10000 INT(255) NOT NULL default 0,
    Total_words_10 INT(255) NOT NULL default 0,
    PRIMARY KEY(URL)
    );

LOAD DATA LOCAL INFILE '/tmp/FINAL_DATA_FOR_SQL.csv' INTO TABLE PoliticsAll
    FIELDS TERMINATED BY ',' LINES TERMINATED BY '\r\n';
    
SELECT SUM(1) AS num_articles FROM PoliticsAll;